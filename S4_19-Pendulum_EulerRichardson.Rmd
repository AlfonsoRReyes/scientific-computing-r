---
title: "R Notebook"
output: html_notebook
---


```{r}
# ########################################################## Test EulerRichardson
library(testthat)
source("./R/ODE.R")
source("./R/EulerRichardson.R")

ode <- new("ODE")

expect_error(EulerRichardson(), 'argument ".ode" is missing, with no default')

eulerRichardson <- EulerRichardson(ode)

state <- c(0, 1, 3)
rate  <- c(0, 0, 0)

eulerRichardson@ode@state <-  c(0, 1, 3)             # set a vector for state

# expect_equal(getStepSize(euler), 0.1)        # get default step size
# 
# ----------------------------------------- these two vars hold no values
expect_true(length(ode@state) == 0)
expect_true(length(ode@rate)  == 0)

# ++++++++++++++++++++++++++++++++++++++++++++++++ values stored here
expect_true(all(eulerRichardson@ode@state == state))
expect_true(length(eulerRichardson@ode@rate) == 0)

# ++++++++++++++++++++++++++++++++++++++++++++++++ test init
eulerRichardson <- init(eulerRichardson, 0.123)

expect_equal(eulerRichardson@ode@state, state)
expect_equal(eulerRichardson@numEqn, 3)
# 
# euler <- setStepSize(euler, 0.1010)     # set a new step size
# expect_equal(getStepSize(euler), 0.1010)
# 
expect_true(!is.null(step(eulerRichardson)))  # step from Euler returns a value
expect_true(length(ode@rate)  == 0)
expect_equal(getRate(eulerRichardson@ode), c(0, 0, 0))

# ++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++ test step()
# rate is zero until we do setState and getRate
eulerRichardson <- step(eulerRichardson)
expect_equal(eulerRichardson@ode@state, state)
expect_equal(eulerRichardson@ode@rate, rate)

eulerRichardson <- step(eulerRichardson)
expect_equal(eulerRichardson@ode@state, state)
expect_equal(eulerRichardson@ode@rate, rate)

eulerRichardson <- step(eulerRichardson)
expect_equal(eulerRichardson@ode@state, state)
expect_equal(eulerRichardson@ode@rate, rate)



```

